"undefined"==typeof module&&(module={exports:void 0});var jsel=null;module.exports=jsel=function(){function e(){this.init()}function t(e){this.expression=e}function r(){}function n(e){arguments.length>0&&this.init(e)}function o(e){arguments.length>0&&this.init(e)}function s(e,t){arguments.length>0&&this.init(e,t)}function i(e,t){arguments.length>0&&this.init(e,t)}function a(e,t){arguments.length>0&&this.init(e,t)}function u(e,t){arguments.length>0&&this.init(e,t)}function p(e,t){arguments.length>0&&this.init(e,t)}function c(e,t){arguments.length>0&&this.init(e,t)}function l(e,t){arguments.length>0&&this.init(e,t)}function h(e,t){arguments.length>0&&this.init(e,t)}function f(e,t){arguments.length>0&&this.init(e,t)}function d(e,t){arguments.length>0&&this.init(e,t)}function g(e,t){arguments.length>0&&this.init(e,t)}function y(e,t){arguments.length>0&&this.init(e,t)}function m(e,t){arguments.length>0&&this.init(e,t)}function v(e,t){arguments.length>0&&this.init(e,t)}function b(e,t){arguments.length>0&&this.init(e,t)}function x(e,t,r){arguments.length>0&&this.init(e,t,r)}function w(e,t){arguments.length>0&&this.init(e,t)}function E(e,t,r){arguments.length>0&&this.init(e,t,r)}function N(e,t){arguments.length>0&&this.init(e,t)}function T(e){arguments.length>0&&this.init(e)}function A(e,t){arguments.length>0&&this.init(e,t)}function S(e){arguments.length>0&&this.init(e)}function _(e){arguments.length>0&&this.init(e)}function k(e){arguments.length>0&&this.init(e)}function O(e){this.init(e)}function R(){this.init()}function D(e,t,r){this.variableResolver=null!=e?e:new I,this.namespaceResolver=null!=t?t:new F,this.functionResolver=null!=r?r:new C}function I(){}function F(){}function C(e){this.thisArg=null!=e?e:Functions,this.functions=new Object,this.addStandardFunctions()}function U(e,t){this.code=e,this.exception=t}function P(e,t,r){this.xpath=r.parse(e),this.context=new D,this.context.namespaceResolver=new L(t)}function L(e){this.xpathNSResolver=e}function M(e){this.node=e,this.namespaceResolver=new F}function j(e,t){switch(t==j.ANY_TYPE&&(e.constructor===S?t=j.STRING_TYPE:e.constructor===_?t=j.NUMBER_TYPE:e.constructor===k?t=j.BOOLEAN_TYPE:e.constructor===R&&(t=j.UNORDERED_NODE_ITERATOR_TYPE)),this.resultType=t,t){case j.NUMBER_TYPE:return this.numberValue=e.numberValue(),void 0;case j.STRING_TYPE:return this.stringValue=e.stringValue(),void 0;case j.BOOLEAN_TYPE:return this.booleanValue=e.booleanValue(),void 0;case j.ANY_UNORDERED_NODE_TYPE:case j.FIRST_ORDERED_NODE_TYPE:if(e.constructor===R)return this.singleNodeValue=e.first(),void 0;break;case j.UNORDERED_NODE_ITERATOR_TYPE:case j.ORDERED_NODE_ITERATOR_TYPE:if(e.constructor===R)return this.invalidIteratorState=!1,this.nodes=e.toArray(),this.iteratorIndex=0,void 0;break;case j.UNORDERED_NODE_SNAPSHOT_TYPE:case j.ORDERED_NODE_SNAPSHOT_TYPE:if(e.constructor===R)return this.nodes=e.toArray(),this.snapshotLength=this.nodes.length,void 0}throw new U(U.TYPE_ERR)}function V(t,r,n,o){P.mappings=o;var t=new P(t,null,new e),s=j.ANY_TYPE,i=t.evaluate(r,s,null);return i.resultType==j.STRING_TYPE?i=i.stringValue:i.resultType==j.NUMBER_TYPE?i=i.numberValue:i.resultType==j.BOOLEAN_TYPE?i=i.booleanValue:(i=i.nodes,n&&(i=i[0])),i}function B(e){if("function"==typeof Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}function H(e,t,r){var n,o=[];if(e instanceof Array)for(var s=0;s<e.length;s++)o.push(t.call(r||e,e[s],s));else{n=B(e);for(var s=0;s<n.length;s++)o.push(t.call(r||e,e[n[s]],n[s]))}return o}function W(e,t){this.nodeName=e,this.childNodes=t}function q(e,t){this.nodeName=e,this.value=t}function Y(e){this._schema={},this._map={},this._node=e,H(Q,function(e,t){this._schema[t]=e},this)}function G(e,t,r){this.node=e,this.cache={ownerDocument:r,parentNode:t}}function z(e,t,r){this.name=e,this.value=t,this.cache={parentNode:r}}function $(e,t,r){this.txt=e,this.cache={ownerDocument:r,parentNode:t}}e.prototype=new Object,e.prototype.constructor=e,e.superclass=Object.prototype,e.prototype.init=function(){this.reduceActions=[],this.reduceActions[3]=function(e){return new i(e[0],e[2])},this.reduceActions[5]=function(e){return new a(e[0],e[2])},this.reduceActions[7]=function(e){return new u(e[0],e[2])},this.reduceActions[8]=function(e){return new p(e[0],e[2])},this.reduceActions[10]=function(e){return new c(e[0],e[2])},this.reduceActions[11]=function(e){return new l(e[0],e[2])},this.reduceActions[12]=function(e){return new h(e[0],e[2])},this.reduceActions[13]=function(e){return new f(e[0],e[2])},this.reduceActions[15]=function(e){return new d(e[0],e[2])},this.reduceActions[16]=function(e){return new g(e[0],e[2])},this.reduceActions[18]=function(e){return new y(e[0],e[2])},this.reduceActions[19]=function(e){return new m(e[0],e[2])},this.reduceActions[20]=function(e){return new v(e[0],e[2])},this.reduceActions[22]=function(e){return new o(e[1])},this.reduceActions[24]=function(e){return new b(e[0],e[2])},this.reduceActions[25]=function(e){return new x(void 0,void 0,e[0])},this.reduceActions[27]=function(e){return e[0].locationPath=e[2],e[0]},this.reduceActions[28]=function(e){return e[0].locationPath=e[2],e[0].locationPath.steps.unshift(new E(E.DESCENDANTORSELF,new N(N.NODE,void 0),[])),e[0]},this.reduceActions[29]=function(e){return new x(e[0],[],void 0)},this.reduceActions[30]=function(e){return Utilities.instance_of(e[0],x)?(void 0==e[0].filterPredicates&&(e[0].filterPredicates=[]),e[0].filterPredicates.push(e[1]),e[0]):new x(e[0],[e[1]],void 0)},this.reduceActions[32]=function(e){return e[1]},this.reduceActions[33]=function(e){return new S(e[0])},this.reduceActions[34]=function(e){return new _(e[0])},this.reduceActions[36]=function(e){return new A(e[0],[])},this.reduceActions[37]=function(e){return new A(e[0],e[2])},this.reduceActions[38]=function(e){return[e[0]]},this.reduceActions[39]=function(e){return e[2].unshift(e[0]),e[2]},this.reduceActions[43]=function(){return new w(!0,[])},this.reduceActions[44]=function(e){return e[1].absolute=!0,e[1]},this.reduceActions[46]=function(e){return new w(!1,[e[0]])},this.reduceActions[47]=function(e){return e[0].steps.push(e[2]),e[0]},this.reduceActions[49]=function(e){return new E(e[0],e[1],[])},this.reduceActions[50]=function(e){return new E(E.CHILD,e[0],[])},this.reduceActions[51]=function(e){return new E(e[0],e[1],e[2])},this.reduceActions[52]=function(e){return new E(E.CHILD,e[0],e[1])},this.reduceActions[54]=function(e){return[e[0]]},this.reduceActions[55]=function(e){return e[1].unshift(e[0]),e[1]},this.reduceActions[56]=function(e){return"ancestor"==e[0]?E.ANCESTOR:"ancestor-or-self"==e[0]?E.ANCESTORORSELF:"attribute"==e[0]?E.ATTRIBUTE:"child"==e[0]?E.CHILD:"descendant"==e[0]?E.DESCENDANT:"descendant-or-self"==e[0]?E.DESCENDANTORSELF:"following"==e[0]?E.FOLLOWING:"following-sibling"==e[0]?E.FOLLOWINGSIBLING:"namespace"==e[0]?E.NAMESPACE:"parent"==e[0]?E.PARENT:"preceding"==e[0]?E.PRECEDING:"preceding-sibling"==e[0]?E.PRECEDINGSIBLING:"self"==e[0]?E.SELF:-1},this.reduceActions[57]=function(){return E.ATTRIBUTE},this.reduceActions[59]=function(e){return"comment"==e[0]?new N(N.COMMENT,void 0):"text"==e[0]?new N(N.TEXT,void 0):"processing-instruction"==e[0]?new N(N.PI,void 0):"node"==e[0]?new N(N.NODE,void 0):new N(-1,void 0)},this.reduceActions[60]=function(e){return new N(N.PI,e[2])},this.reduceActions[61]=function(e){return e[1]},this.reduceActions[63]=function(e){return e[1].absolute=!0,e[1].steps.unshift(new E(E.DESCENDANTORSELF,new N(N.NODE,void 0),[])),e[1]},this.reduceActions[64]=function(e){return e[0].steps.push(new E(E.DESCENDANTORSELF,new N(N.NODE,void 0),[])),e[0].steps.push(e[2]),e[0]},this.reduceActions[65]=function(){return new E(E.SELF,new N(N.NODE,void 0),[])},this.reduceActions[66]=function(){return new E(E.PARENT,new N(N.NODE,void 0),[])},this.reduceActions[67]=function(e){return new T(e[1])},this.reduceActions[68]=function(){return new N(N.NAMETESTANY,void 0)},this.reduceActions[69]=function(e){var t=e[0].substring(0,e[0].indexOf(":"));return new N(N.NAMETESTPREFIXANY,t)},this.reduceActions[70]=function(e){return new N(N.NAMETESTQNAME,e[0])}},e.actionTable=[" s s        sssssssss    s ss  s  ss","                 s                  ","r  rrrrrrrrr         rrrrrrr rr  r  ","                rrrrr               "," s s        sssssssss    s ss  s  ss","rs  rrrrrrrr s  sssssrrrrrr  rrs rs "," s s        sssssssss    s ss  s  ss","                            s       ","                            s       ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","  s                                 ","                            s       "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr  r  ","a                                   ","r       s                    rr  r  ","r      sr                    rr  r  ","r   s  rr            s       rr  r  ","r   rssrr            rss     rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrrs  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r  srrrrrrrr         rrrrrrs rr sr  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r   rrrrrrrr         rrrrrr  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","                sssss               ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             s      ","r  srrrrrrrr         rrrrrrs rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","              s                     ","                             s      ","                rrrrr               "," s s        sssssssss    s sss s  ss","r  srrrrrrrr         rrrrrrs rr  r  "," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss      ss  s  ss"," s s        sssssssss    s ss  s  ss"," s           s  sssss          s  s "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr rr  "," s           s  sssss          s  s "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             s      ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             rr     ","                             s      ","                             rs     ","r      sr                    rr  r  ","r   s  rr            s       rr  r  ","r   rssrr            rss     rr  r  ","r   rssrr            rss     rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","                                 r  ","                                 s  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  "," s s        sssssssss    s ss  s  ss","r  rrrrrrrrr         rrrrrrr rr rr  ","                             r      "],e.actionTableNumber=[" 1 0        /.-,+*)('    & %$  #  \"!","                 J                  ","a  aaaaaaaaa         aaaaaaa aa  a  ","                YYYYY               "," 1 0        /.-,+*)('    & %$  #  \"!","K1  KKKKKKKK .  +*)('KKKKKK  KK# K\" "," 1 0        /.-,+*)('    & %$  #  \"!","                            N       ","                            O       ","e  eeeeeeeee         eeeeeee ee ee  ","f  fffffffff         fffffff ff ff  ","d  ddddddddd         ddddddd dd dd  ","B  BBBBBBBBB         BBBBBBB BB BB  ","A  AAAAAAAAA         AAAAAAA AA AA  ","  P                                 ","                            Q       "," 1           .  +*)('          #  \" ","b  bbbbbbbbb         bbbbbbb bb  b  ","                                    ","!       S                    !!  !  ",'"      T"                    ""  "  ',"$   V  $$            U       $$  $  ","&   &ZY&&            &XW     &&  &  ",")   )))))            )))\\[   ))  )  ",".   ....._^]         .....   ..  .  ","1   11111111         11111   11  1  ","5   55555555         55555`  55  5  ","7   77777777         777777  77  7  ","9   99999999         999999  99  9  ",":  c::::::::         ::::::b :: a:  ","I  fIIIIIIII         IIIIIIe II  I  ","=  =========         ======= == ==  ","?  ?????????         ??????? ?? ??  ","C  CCCCCCCCC         CCCCCCC CC CC  ","J   JJJJJJJJ         JJJJJJ  JJ  J  ","M   MMMMMMMM         MMMMMM  MM  M  ","N  NNNNNNNNN         NNNNNNN NN  N  ","P  PPPPPPPPP         PPPPPPP PP  P  ","                +*)('               ","R  RRRRRRRRR         RRRRRRR RR aR  ","U  UUUUUUUUU         UUUUUUU UU  U  ","Z  ZZZZZZZZZ         ZZZZZZZ ZZ ZZ  ","c  ccccccccc         ccccccc cc cc  ","                             j      ","L  fLLLLLLLL         LLLLLLe LL  L  ","6   66666666         66666   66  6  ","              k                     ","                             l      ","                XXXXX               "," 1 0        /.-,+*)('    & %$m #  \"!","_  f________         ______e __  _  "," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('      %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1           .  +*)('          #  \" "," 1           .  +*)('          #  \" ",">  >>>>>>>>>         >>>>>>> >> >>  "," 1           .  +*)('          #  \" "," 1           .  +*)('          #  \" ","Q  QQQQQQQQQ         QQQQQQQ QQ aQ  ","V  VVVVVVVVV         VVVVVVV VV aV  ","T  TTTTTTTTT         TTTTTTT TT  T  ","@  @@@@@@@@@         @@@@@@@ @@ @@  ","                                   ","[  [[[[[[[[[         [[[[[[[ [[ [[  ","D  DDDDDDDDD         DDDDDDD DD DD  ","                             HH     ","                                   ","                             F     ","#      T#                    ##  #  ","%   V  %%            U       %%  %  ","'   'ZY''            'XW     ''  '  ","(   (ZY((            (XW     ((  (  ","+   +++++            +++\\[   ++  +  ","*   *****            ***\\[   **  *  ","-   -----            ---\\[   --  -  ",",   ,,,,,            ,,,\\[   ,,  ,  ","0   00000_^]         00000   00  0  ","/   /////_^]         /////   //  /  ","2   22222222         22222   22  2  ","3   33333333         33333   33  3  ","4   44444444         44444   44  4  ","8   88888888         888888  88  8  ","                                 ^  ","                                   ",";  f;;;;;;;;         ;;;;;;e ;;  ;  ","<  f<<<<<<<<         <<<<<<e <<  <  ","O  OOOOOOOOO         OOOOOOO OO  O  ","`  `````````         ``````` ``  `  ","S  SSSSSSSSS         SSSSSSS SS  S  ","W  WWWWWWWWW         WWWWWWW WW  W  ","\\  \\\\\\\\\\\\\\\\\\         \\\\\\\\\\\\\\ \\\\ \\\\  ","E  EEEEEEEEE         EEEEEEE EE EE  "," 1 0        /.-,+*)('    & %$  #  \"!","]  ]]]]]]]]]         ]]]]]]] ]] ]]  ","                             G      "],e.gotoTable=["3456789:;<=>?@ AB  CDEFGH IJ ","                             ","                             ","                             ","L456789:;<=>?@ AB  CDEFGH IJ ","            M        EFGH IJ ","       N;<=>?@ AB  CDEFGH IJ ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","            S        EFGH IJ ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","              e              ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                        h  J ","              i          j   ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","o456789:;<=>?@ ABpqCDEFGH IJ ","                             ","  r6789:;<=>?@ AB  CDEFGH IJ ","   s789:;<=>?@ AB  CDEFGH IJ ","    t89:;<=>?@ AB  CDEFGH IJ ","    u89:;<=>?@ AB  CDEFGH IJ ","     v9:;<=>?@ AB  CDEFGH IJ ","     w9:;<=>?@ AB  CDEFGH IJ ","     x9:;<=>?@ AB  CDEFGH IJ ","     y9:;<=>?@ AB  CDEFGH IJ ","      z:;<=>?@ AB  CDEFGH IJ ","      {:;<=>?@ AB  CDEFGH IJ ","       |;<=>?@ AB  CDEFGH IJ ","       };<=>?@ AB  CDEFGH IJ ","       ~;<=>?@ AB  CDEFGH IJ ","         =>?@ AB  CDEFGH IJ ","456789:;<=>?@ AB  CDEFGH IJ","                    EFGH IJ ","                    EFGH IJ ","                             ","                      GH IJ ","                      GH IJ ","              i             ","              i             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","o456789:;<=>?@ ABqCDEFGH IJ ","                             ","                             "],e.productions=[[1,1,2],[2,1,3],[3,1,4],[3,3,3,-9,4],[4,1,5],[4,3,4,-8,5],[5,1,6],[5,3,5,-22,6],[5,3,5,-5,6],[6,1,7],[6,3,6,-23,7],[6,3,6,-24,7],[6,3,6,-6,7],[6,3,6,-7,7],[7,1,8],[7,3,7,-25,8],[7,3,7,-26,8],[8,1,9],[8,3,8,-12,9],[8,3,8,-11,9],[8,3,8,-10,9],[9,1,10],[9,2,-26,9],[10,1,11],[10,3,10,-27,11],[11,1,12],[11,1,13],[11,3,13,-28,14],[11,3,13,-4,14],[13,1,15],[13,2,13,16],[15,1,17],[15,3,-29,2,-30],[15,1,-15],[15,1,-16],[15,1,18],[18,3,-13,-29,-30],[18,4,-13,-29,19,-30],[19,1,20],[19,3,20,-31,19],[20,1,2],[12,1,14],[12,1,21],[21,1,-28],[21,2,-28,14],[21,1,22],[14,1,23],[14,3,14,-28,23],[14,1,24],[23,2,25,26],[23,1,26],[23,3,25,26,27],[23,2,26,27],[23,1,28],[27,1,16],[27,2,16,27],[25,2,-14,-3],[25,1,-32],[26,1,29],[26,3,-20,-29,-30],[26,4,-21,-29,-15,-30],[16,3,-33,30,-34],[30,1,2],[22,2,-4,14],[24,3,14,-4,23],[28,1,-35],[28,1,-2],[17,2,-36,-18],[29,1,-17],[29,1,-19],[29,1,-18]],e.DOUBLEDOT=2,e.DOUBLECOLON=3,e.DOUBLESLASH=4,e.NOTEQUAL=5,e.LESSTHANOREQUAL=6,e.GREATERTHANOREQUAL=7,e.AND=8,e.OR=9,e.MOD=10,e.DIV=11,e.MULTIPLYOPERATOR=12,e.FUNCTIONNAME=13,e.AXISNAME=14,e.LITERAL=15,e.NUMBER=16,e.ASTERISKNAMETEST=17,e.QNAME=18,e.NCNAMECOLONASTERISK=19,e.NODETYPE=20,e.PROCESSINGINSTRUCTIONWITHLITERAL=21,e.EQUALS=22,e.LESSTHAN=23,e.GREATERTHAN=24,e.PLUS=25,e.MINUS=26,e.BAR=27,e.SLASH=28,e.LEFTPARENTHESIS=29,e.RIGHTPARENTHESIS=30,e.COMMA=31,e.AT=32,e.LEFTBRACKET=33,e.RIGHTBRACKET=34,e.DOT=35,e.DOLLAR=36,e.prototype.tokenize=function(t){for(var r=[],n=[],o=t+"\0",s=0,i=o.charAt(s++);;){for(;" "==i||"	"==i||"\r"==i||"\n"==i;)i=o.charAt(s++);if("\0"==i||s>=o.length)break;if("("!=i)if(")"!=i)if("["!=i)if("]"!=i)if("@"!=i)if(","!=i)if("|"!=i)if("+"!=i)if("-"!=i)if("="!=i)if("$"!=i)if("."!=i)if("'"!=i&&'"'!=i)if(i>="0"&&"9">=i){var a=i;for(i=o.charAt(s++);i>="0"&&"9">=i;)a+=i,i=o.charAt(s++);if("."==i&&o.charAt(s)>="0"&&o.charAt(s)<="9")for(a+=i,a+=o.charAt(s++),i=o.charAt(s++);i>="0"&&"9">=i;)a+=i,i=o.charAt(s++);r.push(e.NUMBER),n.push(a)}else if("*"!=i)if(":"!=i||":"!=o.charAt(s))if("/"!=i)if("!"!=i||"="!=o.charAt(s))if("<"!=i)if(">"!=i){if("_"!=i&&!Utilities.isLetter(i.charCodeAt(0)))throw new Error("Unexpected character "+i);var u=i;for(i=o.charAt(s++);Utilities.isNCNameChar(i.charCodeAt(0));)u+=i,i=o.charAt(s++);if(r.length>0){var p=r[r.length-1];if(p!=e.AT&&p!=e.DOUBLECOLON&&p!=e.LEFTPARENTHESIS&&p!=e.LEFTBRACKET&&p!=e.AND&&p!=e.OR&&p!=e.MOD&&p!=e.DIV&&p!=e.MULTIPLYOPERATOR&&p!=e.SLASH&&p!=e.DOUBLESLASH&&p!=e.BAR&&p!=e.PLUS&&p!=e.MINUS&&p!=e.EQUALS&&p!=e.NOTEQUAL&&p!=e.LESSTHAN&&p!=e.LESSTHANOREQUAL&&p!=e.GREATERTHAN&&p!=e.GREATERTHANOREQUAL){if("and"==u){r.push(e.AND),n.push(u);continue}if("or"==u){r.push(e.OR),n.push(u);continue}if("mod"==u){r.push(e.MOD),n.push(u);continue}if("div"==u){r.push(e.DIV),n.push(u);continue}}}if(":"==i){if("*"==o.charAt(s)){r.push(e.NCNAMECOLONASTERISK),n.push(u+":*"),s++,i=o.charAt(s++);continue}if("_"==o.charAt(s)||Utilities.isLetter(o.charCodeAt(s))){for(u+=":",i=o.charAt(s++);Utilities.isNCNameChar(i.charCodeAt(0));)u+=i,i=o.charAt(s++);if("("==i){r.push(e.FUNCTIONNAME),n.push(u);continue}r.push(e.QNAME),n.push(u);continue}if(":"==o.charAt(s)){r.push(e.AXISNAME),n.push(u);continue}}if("("==i){if("comment"==u||"text"==u||"node"==u){r.push(e.NODETYPE),n.push(u);continue}if("processing-instruction"==u){")"==o.charAt(s)?r.push(e.NODETYPE):r.push(e.PROCESSINGINSTRUCTIONWITHLITERAL),n.push(u);continue}r.push(e.FUNCTIONNAME),n.push(u);continue}r.push(e.QNAME),n.push(u)}else{if("="==o.charAt(s)){r.push(e.GREATERTHANOREQUAL),n.push(">="),s++,i=o.charAt(s++);continue}r.push(e.GREATERTHAN),n.push(">"),i=o.charAt(s++)}else{if("="==o.charAt(s)){r.push(e.LESSTHANOREQUAL),n.push("<="),s++,i=o.charAt(s++);continue}r.push(e.LESSTHAN),n.push("<"),i=o.charAt(s++)}else r.push(e.NOTEQUAL),n.push("!="),s++,i=o.charAt(s++);else{if(i=o.charAt(s++),"/"==i){r.push(e.DOUBLESLASH),n.push("//"),i=o.charAt(s++);continue}r.push(e.SLASH),n.push("/")}else r.push(e.DOUBLECOLON),n.push("::"),s++,i=o.charAt(s++);else{if(r.length>0){var p=r[r.length-1];if(p!=e.AT&&p!=e.DOUBLECOLON&&p!=e.LEFTPARENTHESIS&&p!=e.LEFTBRACKET&&p!=e.AND&&p!=e.OR&&p!=e.MOD&&p!=e.DIV&&p!=e.MULTIPLYOPERATOR&&p!=e.SLASH&&p!=e.DOUBLESLASH&&p!=e.BAR&&p!=e.PLUS&&p!=e.MINUS&&p!=e.EQUALS&&p!=e.NOTEQUAL&&p!=e.LESSTHAN&&p!=e.LESSTHANOREQUAL&&p!=e.GREATERTHAN&&p!=e.GREATERTHANOREQUAL){r.push(e.MULTIPLYOPERATOR),n.push(i),i=o.charAt(s++);continue}}r.push(e.ASTERISKNAMETEST),n.push(i),i=o.charAt(s++)}else{for(var c=i,l="";(i=o.charAt(s++))!=c;)l+=i;r.push(e.LITERAL),n.push(l),i=o.charAt(s++)}else{if(i=o.charAt(s++),"."==i){r.push(e.DOUBLEDOT),n.push(".."),i=o.charAt(s++);continue}if(i>="0"&&"9">=i){var a="."+i;for(i=o.charAt(s++);i>="0"&&"9">=i;)a+=i,i=o.charAt(s++);r.push(e.NUMBER),n.push(a);continue}r.push(e.DOT),n.push(".")}else r.push(e.DOLLAR),n.push(i),i=o.charAt(s++);else r.push(e.EQUALS),n.push(i),i=o.charAt(s++);else r.push(e.MINUS),n.push(i),i=o.charAt(s++);else r.push(e.PLUS),n.push(i),i=o.charAt(s++);else r.push(e.BAR),n.push(i),i=o.charAt(s++);else r.push(e.COMMA),n.push(i),i=o.charAt(s++);else r.push(e.AT),n.push(i),i=o.charAt(s++);else r.push(e.RIGHTBRACKET),n.push(i),i=o.charAt(s++);else r.push(e.LEFTBRACKET),n.push(i),i=o.charAt(s++);else r.push(e.RIGHTPARENTHESIS),n.push(i),i=o.charAt(s++);else r.push(e.LEFTPARENTHESIS),n.push(i),i=o.charAt(s++)}return r.push(1),n.push("[EOF]"),[r,n]},e.SHIFT="s",e.REDUCE="r",e.ACCEPT="a",e.prototype.parse=function(r){var n,o,s=this.tokenize(r);if(void 0==s)return void 0;n=s[0],o=s[1];var r,i,a,u=0,p=[],c=[],l=[];for(p.push(0),c.push(1),l.push("_S"),i=n[u],a=o[u++];;)switch(r=p[p.length-1],e.actionTable[r].charAt(i-1)){case e.SHIFT:c.push(-i),l.push(a),p.push(e.actionTableNumber[r].charCodeAt(i-1)-32),i=n[u],a=o[u++];break;case e.REDUCE:for(var h=e.productions[e.actionTableNumber[r].charCodeAt(i-1)-32][1],f=[],d=0;h>d;d++)c.pop(),f.unshift(l.pop()),p.pop();var g=p[p.length-1];c.push(e.productions[e.actionTableNumber[r].charCodeAt(i-1)-32][0]),void 0==this.reduceActions[e.actionTableNumber[r].charCodeAt(i-1)-32]?l.push(f[0]):l.push(this.reduceActions[e.actionTableNumber[r].charCodeAt(i-1)-32](f)),p.push(e.gotoTable[g].charCodeAt(e.productions[e.actionTableNumber[r].charCodeAt(i-1)-32][0]-2)-33);break;case e.ACCEPT:return new t(l.pop());default:throw new Error("XPath parse error")}},t.prototype=new Object,t.prototype.constructor=t,t.superclass=Object.prototype,t.prototype.toString=function(){return this.expression.toString()},t.prototype.evaluate=function(e){return e.contextNode=e.expressionContextNode,e.contextSize=1,e.contextPosition=1,e.caseInsensitive=!0,this.expression.evaluate(e)},t.XML_NAMESPACE_URI="http://www.w3.org/XML/1998/namespace",t.XMLNS_NAMESPACE_URI="http://www.w3.org/2000/xmlns/",r.prototype=new Object,r.prototype.constructor=r,r.superclass=Object.prototype,r.prototype.init=function(){},r.prototype.toString=function(){return"<Expression>"},r.prototype.evaluate=function(){throw new Error("Could not evaluate expression.")},n.prototype=new r,n.prototype.constructor=n,n.superclass=r.prototype,n.prototype.init=function(e){this.rhs=e},o.prototype=new n,o.prototype.constructor=o,o.superclass=n.prototype,o.prototype.init=function(e){o.superclass.init.call(this,e)},o.prototype.evaluate=function(e){return this.rhs.evaluate(e).number().negate()},o.prototype.toString=function(){return"-"+this.rhs.toString()},s.prototype=new r,s.prototype.constructor=s,s.superclass=r.prototype,s.prototype.init=function(e,t){this.lhs=e,this.rhs=t},i.prototype=new s,i.prototype.constructor=i,i.superclass=s.prototype,i.prototype.init=function(e,t){i.superclass.init.call(this,e,t)},i.prototype.toString=function(){return"("+this.lhs.toString()+" or "+this.rhs.toString()+")"},i.prototype.evaluate=function(e){var t=this.lhs.evaluate(e).bool();return t.booleanValue()?t:this.rhs.evaluate(e).bool()},a.prototype=new s,a.prototype.constructor=a,a.superclass=s.prototype,a.prototype.init=function(e,t){a.superclass.init.call(this,e,t)},a.prototype.toString=function(){return"("+this.lhs.toString()+" and "+this.rhs.toString()+")"},a.prototype.evaluate=function(e){var t=this.lhs.evaluate(e).bool();return t.booleanValue()?this.rhs.evaluate(e).bool():t},u.prototype=new s,u.prototype.constructor=u,u.superclass=s.prototype,u.prototype.init=function(e,t){u.superclass.init.call(this,e,t)},u.prototype.toString=function(){return"("+this.lhs.toString()+" = "+this.rhs.toString()+")"},u.prototype.evaluate=function(e){return this.lhs.evaluate(e).equals(this.rhs.evaluate(e))},p.prototype=new s,p.prototype.constructor=p,p.superclass=s.prototype,p.prototype.init=function(e,t){p.superclass.init.call(this,e,t)},p.prototype.toString=function(){return"("+this.lhs.toString()+" != "+this.rhs.toString()+")"},p.prototype.evaluate=function(e){return this.lhs.evaluate(e).notequal(this.rhs.evaluate(e))},c.prototype=new s,c.prototype.constructor=c,c.superclass=s.prototype,c.prototype.init=function(e,t){c.superclass.init.call(this,e,t)},c.prototype.evaluate=function(e){return this.lhs.evaluate(e).lessthan(this.rhs.evaluate(e))},c.prototype.toString=function(){return"("+this.lhs.toString()+" < "+this.rhs.toString()+")"},l.prototype=new s,l.prototype.constructor=l,l.superclass=s.prototype,l.prototype.init=function(e,t){l.superclass.init.call(this,e,t)},l.prototype.evaluate=function(e){return this.lhs.evaluate(e).greaterthan(this.rhs.evaluate(e))},l.prototype.toString=function(){return"("+this.lhs.toString()+" > "+this.rhs.toString()+")"},h.prototype=new s,h.prototype.constructor=h,h.superclass=s.prototype,h.prototype.init=function(e,t){h.superclass.init.call(this,e,t)},h.prototype.evaluate=function(e){return this.lhs.evaluate(e).lessthanorequal(this.rhs.evaluate(e))},h.prototype.toString=function(){return"("+this.lhs.toString()+" <= "+this.rhs.toString()+")"},f.prototype=new s,f.prototype.constructor=f,f.superclass=s.prototype,f.prototype.init=function(e,t){f.superclass.init.call(this,e,t)},f.prototype.evaluate=function(e){return this.lhs.evaluate(e).greaterthanorequal(this.rhs.evaluate(e))},f.prototype.toString=function(){return"("+this.lhs.toString()+" >= "+this.rhs.toString()+")"},d.prototype=new s,d.prototype.constructor=d,d.superclass=s.prototype,d.prototype.init=function(e,t){d.superclass.init.call(this,e,t)},d.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().plus(this.rhs.evaluate(e).number())},d.prototype.toString=function(){return"("+this.lhs.toString()+" + "+this.rhs.toString()+")"},g.prototype=new s,g.prototype.constructor=g,g.superclass=s.prototype,g.prototype.init=function(e,t){g.superclass.init.call(this,e,t)},g.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().minus(this.rhs.evaluate(e).number())},g.prototype.toString=function(){return"("+this.lhs.toString()+" - "+this.rhs.toString()+")"},y.prototype=new s,y.prototype.constructor=y,y.superclass=s.prototype,y.prototype.init=function(e,t){y.superclass.init.call(this,e,t)},y.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().multiply(this.rhs.evaluate(e).number())},y.prototype.toString=function(){return"("+this.lhs.toString()+" * "+this.rhs.toString()+")"},m.prototype=new s,m.prototype.constructor=m,m.superclass=s.prototype,m.prototype.init=function(e,t){m.superclass.init.call(this,e,t)},m.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().div(this.rhs.evaluate(e).number())},m.prototype.toString=function(){return"("+this.lhs.toString()+" div "+this.rhs.toString()+")"},v.prototype=new s,v.prototype.constructor=v,v.superclass=s.prototype,v.prototype.init=function(e,t){v.superclass.init.call(this,e,t)},v.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().mod(this.rhs.evaluate(e).number())},v.prototype.toString=function(){return"("+this.lhs.toString()+" mod "+this.rhs.toString()+")"},b.prototype=new s,b.prototype.constructor=b,b.superclass=s.prototype,b.prototype.init=function(e,t){b.superclass.init.call(this,e,t)
},b.prototype.evaluate=function(e){return this.lhs.evaluate(e).nodeset().union(this.rhs.evaluate(e).nodeset())},b.prototype.toString=function(){return this.lhs.toString()+" | "+this.rhs.toString()},x.prototype=new r,x.prototype.constructor=x,x.superclass=r.prototype,x.prototype.init=function(e,t,r){x.superclass.init.call(this),this.filter=e,this.filterPredicates=t,this.locationPath=r},x.prototype.evaluate=function(e){var r,n=new D;if(n.variableResolver=e.variableResolver,n.functionResolver=e.functionResolver,n.namespaceResolver=e.namespaceResolver,n.expressionContextNode=e.expressionContextNode,n.virtualRoot=e.virtualRoot,n.caseInsensitive=e.caseInsensitive,null==this.filter)r=[e.contextNode];else{var o=this.filter.evaluate(e);if(!Utilities.instance_of(o,R)){if(null!=this.filterPredicates&&this.filterPredicates.length>0||null!=this.locationPath)throw new Error("Path expression filter must evaluate to a nodset if predicates or location path are used");return o}if(r=o.toArray(),null!=this.filterPredicates)for(var s=0;s<this.filterPredicates.length;s++){var i=this.filterPredicates[s],a=[];for(n.contextSize=r.length,n.contextPosition=1;n.contextPosition<=n.contextSize;n.contextPosition++)n.contextNode=r[n.contextPosition-1],this.predicateMatches(i,n)&&a.push(n.contextNode);r=a}}if(null!=this.locationPath){if(this.locationPath.absolute)if(9!=r[0].nodeType())if(null!=n.virtualRoot)r=[n.virtualRoot];else if(null==r[0].ownerDocument()){for(var u=r[0];null!=u.parentNode();)u=u.parentNode();r=[u]}else r=[r[0].ownerDocument()];else r=[r[0]];for(var p=0;p<this.locationPath.steps.length;p++){for(var c=this.locationPath.steps[p],a=[],s=0;s<r.length;s++)switch(n.contextNode=r[s],c.axis){case E.ANCESTOR:if(n.contextNode===n.virtualRoot)break;var l;for(l=2==n.contextNode.nodeType()?this.getOwnerElement(n.contextNode):n.contextNode.parentNode();null!=l&&(c.nodeTest.matches(l,n)&&a.push(l),l!==n.virtualRoot);)l=l.parentNode();break;case E.ANCESTORORSELF:for(var l=n.contextNode;null!=l&&(c.nodeTest.matches(l,n)&&a.push(l),l!==n.virtualRoot);l=2==l.nodeType()?this.getOwnerElement(l):l.parentNode());break;case E.ATTRIBUTE:var h=n.contextNode.attributes();if(null!=h)for(var f=0;f<h.length;f++){var l=h.item(f);c.nodeTest.matches(l,n)&&a.push(l)}break;case E.CHILD:for(var l=n.contextNode.firstChild();null!=l;l=l.nextSibling())c.nodeTest.matches(l,n)&&a.push(l);break;case E.DESCENDANT:for(var d=[n.contextNode.firstChild()];d.length>0;)for(var l=d.pop();null!=l;)c.nodeTest.matches(l,n)&&a.push(l),null!=l.firstChild()?(d.push(l.nextSibling()),l=l.firstChild()):l=l.nextSibling();break;case E.DESCENDANTORSELF:c.nodeTest.matches(n.contextNode,n)&&a.push(n.contextNode);for(var d=[n.contextNode.firstChild()];d.length>0;)for(var l=d.pop();null!=l;)c.nodeTest.matches(l,n)&&a.push(l),null!=l.firstChild()?(d.push(l.nextSibling()),l=l.firstChild()):l=l.nextSibling();break;case E.FOLLOWING:if(n.contextNode===n.virtualRoot)break;var d=[];null!=n.contextNode.firstChild()?d.unshift(n.contextNode.firstChild()):d.unshift(n.contextNode.nextSibling());for(var l=n.contextNode.parentNode();null!=l&&9!=l.nodeType()&&l!==n.virtualRoot;l=l.parentNode())d.unshift(l.nextSibling());do for(var l=d.pop();null!=l;)c.nodeTest.matches(l,n)&&a.push(l),null!=l.firstChild()?(d.push(l.nextSibling()),l=l.firstChild()):l=l.nextSibling();while(d.length>0);break;case E.FOLLOWINGSIBLING:if(n.contextNode===n.virtualRoot)break;for(var l=n.contextNode.nextSibling();null!=l;l=l.nextSibling())c.nodeTest.matches(l,n)&&a.push(l);break;case E.NAMESPACE:var u={};if(1==n.contextNode.nodeType()){u.xml=t.XML_NAMESPACE_URI,u.xmlns=t.XMLNS_NAMESPACE_URI;for(var l=n.contextNode;null!=l&&1==l.nodeType();l=l.parentNode())for(var f=0;f<l.attributes().length;f++){var g=l.attributes().item(f),y=String(g.name);if("xmlns"==y)void 0==u[""]&&(u[""]=g.value);else if(y.length>6&&"xmlns:"==y.substring(0,6)){var m=y.substring(6,y.length);void 0==u[m]&&(u[m]=g.value)}}for(var m in u){var v=new NamespaceNode(m,u[m],n.contextNode);c.nodeTest.matches(v,n)&&a.push(v)}}break;case E.PARENT:l=null,n.contextNode!==n.virtualRoot&&(l=2==n.contextNode.nodeType()?this.getOwnerElement(n.contextNode):n.contextNode.parentNode()),null!=l&&c.nodeTest.matches(l,n)&&a.push(l);break;case E.PRECEDING:var d;d=null!=n.virtualRoot?[n.virtualRoot]:9==n.contextNode.nodeType()?[n.contextNode]:[n.contextNode.ownerDocument()];e:for(;d.length>0;)for(var l=d.pop();null!=l;){if(l==n.contextNode)break e;c.nodeTest.matches(l,n)&&a.unshift(l),null!=l.firstChild()?(d.push(l.nextSibling()),l=l.firstChild()):l=l.nextSibling()}break;case E.PRECEDINGSIBLING:if(n.contextNode===n.virtualRoot)break;for(var l=n.contextNode.previousSibling();null!=l;l=l.previousSibling())c.nodeTest.matches(l,n)&&a.push(l);break;case E.SELF:c.nodeTest.matches(n.contextNode,n)&&a.push(n.contextNode)}r=a;for(var s=0;s<c.predicates.length;s++){var i=c.predicates[s],a=[];for(n.contextSize=r.length,n.contextPosition=1;n.contextPosition<=n.contextSize;n.contextPosition++)n.contextNode=r[n.contextPosition-1],this.predicateMatches(i,n)&&a.push(n.contextNode);r=a}}}var o=new R;return o.addArray(r),o},x.prototype.predicateMatches=function(e,t){var r=e.evaluate(t);return Utilities.instance_of(r,_)?t.contextPosition==r.numberValue():r.booleanValue()},x.prototype.toString=function(){if(void 0!=this.filter){var e=this.filter.toString();if(Utilities.instance_of(this.filter,S)&&(e="'"+e+"'"),void 0!=this.filterPredicates)for(var t=0;t<this.filterPredicates.length;t++)e=e+"["+this.filterPredicates[t].toString()+"]";return void 0!=this.locationPath&&(this.locationPath.absolute||(e+="/"),e+=this.locationPath.toString()),e}return this.locationPath.toString()},x.prototype.getOwnerElement=function(e){if(e.ownerElement)return e.ownerElement;try{if(e.selectSingleNode)return e.selectSingleNode("..")}catch(t){}for(var r=9==e.nodeType()?e:e.ownerDocument(),n=r.getElementsByTagName("*"),o=0;o<n.length;o++)for(var s=n.item(o),i=s.attributes(),a=0;a<i.length;a++){var u=i.item(a);if(u===e)return s}return null},w.prototype=new Object,w.prototype.constructor=w,w.superclass=Object.prototype,w.prototype.init=function(e,t){this.absolute=e,this.steps=t},w.prototype.toString=function(){var e;e=this.absolute?"/":"";for(var t=0;t<this.steps.length;t++)0!=t&&(e+="/"),e+=this.steps[t].toString();return e},E.prototype=new Object,E.prototype.constructor=E,E.superclass=Object.prototype,E.prototype.init=function(e,t,r){this.axis=e,this.nodeTest=t,this.predicates=r},E.prototype.toString=function(){var e;switch(this.axis){case E.ANCESTOR:e="ancestor";break;case E.ANCESTORORSELF:e="ancestor-or-self";break;case E.ATTRIBUTE:e="attribute";break;case E.CHILD:e="child";break;case E.DESCENDANT:e="descendant";break;case E.DESCENDANTORSELF:e="descendant-or-self";break;case E.FOLLOWING:e="following";break;case E.FOLLOWINGSIBLING:e="following-sibling";break;case E.NAMESPACE:e="namespace";break;case E.PARENT:e="parent";break;case E.PRECEDING:e="preceding";break;case E.PRECEDINGSIBLING:e="preceding-sibling";break;case E.SELF:e="self"}e+="::",e+=this.nodeTest.toString();for(var t=0;t<this.predicates.length;t++)e+="["+this.predicates[t].toString()+"]";return e},E.ANCESTOR=0,E.ANCESTORORSELF=1,E.ATTRIBUTE=2,E.CHILD=3,E.DESCENDANT=4,E.DESCENDANTORSELF=5,E.FOLLOWING=6,E.FOLLOWINGSIBLING=7,E.NAMESPACE=8,E.PARENT=9,E.PRECEDING=10,E.PRECEDINGSIBLING=11,E.SELF=12,N.prototype=new Object,N.prototype.constructor=N,N.superclass=Object.prototype,N.prototype.init=function(e,t){this.type=e,this.value=t},N.prototype._matches=function(e,t){if(!e&&!t)return!1;if(P.mappings)for(var r in P.mappings)if(P.mappings.hasOwnProperty(r)){var n=new RegExp(r,"ig"),o=new RegExp(P.mappings[r],"ig");if(n.test(e)&&o.test(t))return!0}return e.toLowerCase()==t.toLowerCase()},N.prototype.matches=function(e,t){switch(this.type){case N.NAMETESTANY:return 2==e.nodeType()||1==e.nodeType()?!0:!1;case N.NAMETESTPREFIXANY:if(2==e.nodeType()||1==e.nodeType()){var r=t.namespaceResolver.getNamespace(this.value,t.expressionContextNode);if(null==r)throw new Error("Cannot resolve QName "+this.value);return!0}return!1;case N.NAMETESTQNAME:if(2==e.nodeType()||1==e.nodeType()){if(this.value.indexOf(":")>-1)return!1;var n=Utilities.resolveQName(this.value,t.namespaceResolver,t.expressionContextNode,!1);if(null==n[0])throw new Error("Cannot resolve QName "+this.value);n[0]=String(n[0]),n[1]=String(n[1]),""==n[0]&&(n[0]=null);var o=Utilities.resolveQName(e.nodeName(),t.namespaceResolver,e,1==e.nodeType());return o[0]=String(o[0]),o[1]=String(o[1]),""==o[0]&&(o[0]=null),this._matches(String(n[1]),String(o[1]))}return!1;case N.COMMENT:return 8==e.nodeType();case N.TEXT:return 3==e.nodeType()||4==e.nodeType();case N.PI:return 7==e.nodeType()&&(null==this.value||e.nodeName(this.value));case N.NODE:return 9==e.nodeType()||1==e.nodeType()||2==e.nodeType()||3==e.nodeType()||4==e.nodeType()||8==e.nodeType()||7==e.nodeType()}return!1},N.prototype.toString=function(){switch(this.type){case N.NAMETESTANY:return"*";case N.NAMETESTPREFIXANY:return this.value+":*";case N.NAMETESTRESOLVEDANY:return"{"+this.value+"}*";case N.NAMETESTQNAME:return this.value;case N.NAMETESTRESOLVEDNAME:return"{"+this.namespaceURI+"}"+this.value;case N.COMMENT:return"comment()";case N.TEXT:return"text()";case N.PI:return void 0!=this.value?'processing-instruction("'+this.value+'")':"processing-instruction()";case N.NODE:return"node()"}return"<unknown nodetest type>"},N.NAMETESTANY=0,N.NAMETESTPREFIXANY=1,N.NAMETESTQNAME=2,N.COMMENT=3,N.TEXT=4,N.PI=5,N.NODE=6,T.prototype=new r,T.prototype.constructor=T,T.superclass=r.prototype,T.prototype.init=function(e){this.variable=e},T.prototype.toString=function(){return"$"+this.variable},T.prototype.evaluate=function(e){return e.variableResolver.getVariable(this.variable,e)},A.prototype=new r,A.prototype.constructor=A,A.superclass=r.prototype,A.prototype.init=function(e,t){this.functionName=e,this.arguments=t},A.prototype.toString=function(){for(var e=this.functionName+"(",t=0;t<this.arguments.length;t++)t>0&&(e+=", "),e+=this.arguments[t].toString();return e+")"},A.prototype.evaluate=function(e){var t=e.functionResolver.getFunction(this.functionName,e);if(void 0==t)throw new Error("Unknown function "+this.functionName);var r=[e].concat(this.arguments);return t.apply(e.functionResolver.thisArg,r)},S.prototype=new r,S.prototype.constructor=S,S.superclass=r.prototype,S.prototype.init=function(e){this.str=e},S.prototype.toString=function(){return this.str},S.prototype.evaluate=function(){return this},S.prototype.string=function(){return this},S.prototype.number=function(){return new _(this.str)},S.prototype.bool=function(){return new k(this.str)},S.prototype.nodeset=function(){throw new Error("Cannot convert string to nodeset")},S.prototype.stringValue=function(){return this.str},S.prototype.numberValue=function(){return this.number().numberValue()},S.prototype.booleanValue=function(){return this.bool().booleanValue()},S.prototype.equals=function(e){return Utilities.instance_of(e,k)?this.bool().equals(e):Utilities.instance_of(e,_)?this.number().equals(e):Utilities.instance_of(e,R)?e.compareWithString(this,J.equals):new k(this.str==e.str)},S.prototype.notequal=function(e){return Utilities.instance_of(e,k)?this.bool().notequal(e):Utilities.instance_of(e,_)?this.number().notequal(e):Utilities.instance_of(e,R)?e.compareWithString(this,J.notequal):new k(this.str!=e.str)},S.prototype.lessthan=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this.number(),J.greaterthanorequal):this.number().lessthan(e.number())},S.prototype.greaterthan=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this.number(),J.lessthanorequal):this.number().greaterthan(e.number())},S.prototype.lessthanorequal=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this.number(),J.greaterthan):this.number().lessthanorequal(e.number())},S.prototype.greaterthanorequal=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this.number(),J.lessthan):this.number().greaterthanorequal(e.number())},_.prototype=new r,_.prototype.constructor=_,_.superclass=r.prototype,_.prototype.init=function(e){this.num=Number(e)},_.prototype.toString=function(){return this.num},_.prototype.evaluate=function(){return this},_.prototype.string=function(){return new S(this.num)},_.prototype.number=function(){return this},_.prototype.bool=function(){return new k(this.num)},_.prototype.nodeset=function(){throw new Error("Cannot convert number to nodeset")},_.prototype.stringValue=function(){return this.string().stringValue()},_.prototype.numberValue=function(){return this.num},_.prototype.booleanValue=function(){return this.bool().booleanValue()},_.prototype.negate=function(){return new _(-this.num)},_.prototype.equals=function(e){return Utilities.instance_of(e,k)?this.bool().equals(e):Utilities.instance_of(e,S)?this.equals(e.number()):Utilities.instance_of(e,R)?e.compareWithNumber(this,J.equals):new k(this.num==e.num)},_.prototype.notequal=function(e){return Utilities.instance_of(e,k)?this.bool().notequal(e):Utilities.instance_of(e,S)?this.notequal(e.number()):Utilities.instance_of(e,R)?e.compareWithNumber(this,J.notequal):new k(this.num!=e.num)},_.prototype.lessthan=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this,J.greaterthanorequal):Utilities.instance_of(e,k)||Utilities.instance_of(e,S)?this.lessthan(e.number()):new k(this.num<e.num)},_.prototype.greaterthan=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this,J.lessthanorequal):Utilities.instance_of(e,k)||Utilities.instance_of(e,S)?this.greaterthan(e.number()):new k(this.num>e.num)},_.prototype.lessthanorequal=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this,J.greaterthan):Utilities.instance_of(e,k)||Utilities.instance_of(e,S)?this.lessthanorequal(e.number()):new k(this.num<=e.num)},_.prototype.greaterthanorequal=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this,J.lessthan):Utilities.instance_of(e,k)||Utilities.instance_of(e,S)?this.greaterthanorequal(e.number()):new k(this.num>=e.num)},_.prototype.plus=function(e){return new _(this.num+e.num)},_.prototype.minus=function(e){return new _(this.num-e.num)},_.prototype.multiply=function(e){return new _(this.num*e.num)},_.prototype.div=function(e){return new _(this.num/e.num)},_.prototype.mod=function(e){return new _(this.num%e.num)},k.prototype=new r,k.prototype.constructor=k,k.superclass=r.prototype,k.prototype.init=function(e){this.b=Boolean(e)},k.prototype.toString=function(){return this.b.toString()},k.prototype.evaluate=function(){return this},k.prototype.string=function(){return new S(this.b)},k.prototype.number=function(){return new _(this.b)},k.prototype.bool=function(){return this},k.prototype.nodeset=function(){throw new Error("Cannot convert boolean to nodeset")},k.prototype.stringValue=function(){return this.string().stringValue()},k.prototype.numberValue=function(){return this.num().numberValue()},k.prototype.booleanValue=function(){return this.b},k.prototype.not=function(){return new k(!this.b)},k.prototype.equals=function(e){return Utilities.instance_of(e,S)||Utilities.instance_of(e,_)?this.equals(e.bool()):Utilities.instance_of(e,R)?e.compareWithBoolean(this,J.equals):new k(this.b==e.b)},k.prototype.notequal=function(e){return Utilities.instance_of(e,S)||Utilities.instance_of(e,_)?this.notequal(e.bool()):Utilities.instance_of(e,R)?e.compareWithBoolean(this,J.notequal):new k(this.b!=e.b)},k.prototype.lessthan=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this.number(),J.greaterthanorequal):this.number().lessthan(e.number())},k.prototype.greaterthan=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this.number(),J.lessthanorequal):this.number().greaterthan(e.number())},k.prototype.lessthanorequal=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this.number(),J.greaterthan):this.number().lessthanorequal(e.number())},k.prototype.greaterthanorequal=function(e){return Utilities.instance_of(e,R)?e.compareWithNumber(this.number(),J.lessthan):this.number().greaterthanorequal(e.number())},O.prototype=new Object,O.prototype.constructor=O,O.superclass=Object.prototype,O.prototype.init=function(e){this.left=null,this.right=null,this.node=e,this.depth=1},O.prototype.balance=function(){var e=null==this.left?0:this.left.depth,t=null==this.right?0:this.right.depth;if(e>t+1){var r=null==this.left.left?0:this.left.left.depth,n=null==this.left.right?0:this.left.right.depth;n>r&&this.left.rotateRR(),this.rotateLL()}else if(t>e+1){var o=null==this.right.right?0:this.right.right.depth,s=null==this.right.left?0:this.right.left.depth;s>o&&this.right.rotateLL(),this.rotateRR()}},O.prototype.rotateLL=function(){var e=this.node,t=this.right;this.node=this.left.node,this.right=this.left,this.left=this.left.left,this.right.left=this.right.right,this.right.right=t,this.right.node=e,this.right.updateInNewLocation(),this.updateInNewLocation()},O.prototype.rotateRR=function(){var e=this.node,t=this.left;this.node=this.right.node,this.left=this.right,this.right=this.right.right,this.left.right=this.left.left,this.left.left=t,this.left.node=e,this.left.updateInNewLocation(),this.updateInNewLocation()},O.prototype.updateInNewLocation=function(){this.getDepthFromChildren()},O.prototype.getDepthFromChildren=function(){this.depth=null==this.node?0:1,null!=this.left&&(this.depth=this.left.depth+1),null!=this.right&&this.depth<=this.right.depth&&(this.depth=this.right.depth+1)},O.prototype.order=function(e,t){if(e===t)return 0;for(var r=0,n=0,o=e;null!=o;o=o.parentNode())r++;for(var s=t;null!=s;s=s.parentNode())n++;if(r>n){for(;r>n;)e=e.parentNode(),r--;if(e==t)return 1}else if(n>r){for(;n>r;)t=t.parentNode(),n--;if(e==t)return-1}for(;e.parentNode()!=t.parentNode();)e=e.parentNode(),t=t.parentNode();for(;null!=e.previousSibling()&&null!=t.previousSibling();)e=e.previousSibling(),t=t.previousSibling();return null==e.previousSibling()?-1:1},O.prototype.add=function(e){if(e===this.node)return!1;var t=this.order(e,this.node),r=!1;return-1==t?null==this.left?(this.left=new O(e),r=!0):(r=this.left.add(e),r&&this.balance()):1==t&&(null==this.right?(this.right=new O(e),r=!0):(r=this.right.add(e),r&&this.balance())),r&&this.getDepthFromChildren(),r},R.prototype=new r,R.prototype.constructor=R,R.superclass=r.prototype,R.prototype.init=function(){this.tree=null,this.size=0},R.prototype.toString=function(){var e=this.first();return null==e?"":this.stringForNode(e)},R.prototype.evaluate=function(){return this},R.prototype.string=function(){return new S(this.toString())},R.prototype.stringValue=function(){return this.toString()},R.prototype.number=function(){return new _(this.string())},R.prototype.numberValue=function(){return Number(this.string())},R.prototype.bool=function(){return new k(null!=this.tree)},R.prototype.booleanValue=function(){return null!=this.tree},R.prototype.nodeset=function(){return this},R.prototype.stringForNode=function(e){return 9==e.nodeType()&&(e=e.documentElement()),1==e.nodeType()?this.stringForNodeRec(e):e.isNamespaceNode?e.namespace:e.nodeValue()},R.prototype.stringForNodeRec=function(e){for(var t="",r=e.firstChild();null!=r;r=r.nextSibling())3==r.nodeType()?t+=r.nodeValue():1==r.nodeType()&&(t+=this.stringForNodeRec(r));return t},R.prototype.first=function(){var e=this.tree;if(null==e)return null;for(;null!=e.left;)e=e.left;return e.node},R.prototype.add=function(e){var t;null==this.tree?(this.tree=new O(e),t=!0):t=this.tree.add(e),t&&this.size++},R.prototype.addArray=function(e){for(var t=0;t<e.length;t++)this.add(e[t])},R.prototype.toArray=function(){var e=[];return this.toArrayRec(this.tree,e),e},R.prototype.toArrayRec=function(e,t){null!=e&&(this.toArrayRec(e.left,t),t.push(e.node),this.toArrayRec(e.right,t))},R.prototype.compareWithString=function(e,t){for(var r=this.toArray(),n=0;n<r.length;n++){var o=r[n],s=new S(this.stringForNode(o)),i=t(s,e);if(i.booleanValue())return i}return new k(!1)},R.prototype.compareWithNumber=function(e,t){for(var r=this.toArray(),n=0;n<r.length;n++){var o=r[n],s=new _(this.stringForNode(o)),i=t(s,e);if(i.booleanValue())return i}return new k(!1)},R.prototype.compareWithBoolean=function(e,t){return t(this.bool(),e)},R.prototype.compareWithNodeSet=function(e,t){for(var r=this.toArray(),n=0;n<r.length;n++)for(var o=r[n],s=new S(this.stringForNode(o)),i=e.toArray(),a=0;a<i.length;a++){var u=i[a],e=new S(this.stringForNode(u)),p=t(s,e);if(p.booleanValue())return p}return new k(!1)},R.prototype.equals=function(e){return Utilities.instance_of(e,S)?this.compareWithString(e,J.equals):Utilities.instance_of(e,_)?this.compareWithNumber(e,J.equals):Utilities.instance_of(e,k)?this.compareWithBoolean(e,J.equals):this.compareWithNodeSet(e,J.equals)},R.prototype.notequal=function(e){return Utilities.instance_of(e,S)?this.compareWithString(e,J.notequal):Utilities.instance_of(e,_)?this.compareWithNumber(e,J.notequal):Utilities.instance_of(e,k)?this.compareWithBoolean(e,J.notequal):this.compareWithNodeSet(e,J.notequal)},R.prototype.lessthan=function(e){return Utilities.instance_of(e,S)?this.compareWithNumber(e.number(),J.lessthan):Utilities.instance_of(e,_)?this.compareWithNumber(e,J.lessthan):Utilities.instance_of(e,k)?this.compareWithBoolean(e,J.lessthan):this.compareWithNodeSet(e,J.lessthan)},R.prototype.greaterthan=function(e){return Utilities.instance_of(e,S)?this.compareWithNumber(e.number(),J.greaterthan):Utilities.instance_of(e,_)?this.compareWithNumber(e,J.greaterthan):Utilities.instance_of(e,k)?this.compareWithBoolean(e,J.greaterthan):this.compareWithNodeSet(e,J.greaterthan)},R.prototype.lessthanorequal=function(e){return Utilities.instance_of(e,S)?this.compareWithNumber(e.number(),J.lessthanorequal):Utilities.instance_of(e,_)?this.compareWithNumber(e,J.lessthanorequal):Utilities.instance_of(e,k)?this.compareWithBoolean(e,J.lessthanorequal):this.compareWithNodeSet(e,J.lessthanorequal)},R.prototype.greaterthanorequal=function(e){return Utilities.instance_of(e,S)?this.compareWithNumber(e.number(),J.greaterthanorequal):Utilities.instance_of(e,_)?this.compareWithNumber(e,J.greaterthanorequal):Utilities.instance_of(e,k)?this.compareWithBoolean(e,J.greaterthanorequal):this.compareWithNodeSet(e,J.greaterthanorequal)},R.prototype.union=function(e){var t=new R;return t.tree=this.tree,t.size=this.size,t.addArray(e.toArray()),t};var J=new Object;J.equals=function(e,t){return e.equals(t)},J.notequal=function(e,t){return e.notequal(t)},J.lessthan=function(e,t){return e.lessthan(t)},J.greaterthan=function(e,t){return e.greaterthan(t)},J.lessthanorequal=function(e,t){return e.lessthanorequal(t)},J.greaterthanorequal=function(e,t){return e.greaterthanorequal(t)},D.prototype=new Object,D.prototype.constructor=D,D.superclass=Object.prototype,I.prototype=new Object,I.prototype.constructor=I,I.superclass=Object.prototype,I.prototype.getVariable=function(e,t){var r=Utilities.splitQName(e);if(null!=r[0]&&(r[0]=t.namespaceResolver.getNamespace(r[0],t.expressionContextNode),null==r[0]))throw new Error("Cannot resolve QName "+fn);return this.getVariableWithName(r[0],r[1],t.expressionContextNode)},I.prototype.getVariableWithName=function(){return null},F.prototype=new Object,F.prototype.constructor=F,F.superclass=Object.prototype,F.prototype.getNamespace=function(e,r){if("xml"==e)return t.XML_NAMESPACE_URI;if("xmlns"==e)return t.XMLNS_NAMESPACE_URI;for(9==r.nodeType()?r=r.documentElement():2==r.nodeType()?r=x.prototype.getOwnerElement(r):1!=r.nodeType()&&(r=r.parentNode());null!=r&&1==r.nodeType();){for(var n=r.attributes(),o=0;o<n.length;o++){var s=n.item(o),i=s.nodeName();if("xmlns"==i&&""==e||i=="xmlns:"+e)return String(s.nodeValue())}r=r.parentNode()}return null},C.prototype=new Object,C.prototype.constructor=C,C.superclass=Object.prototype,C.prototype.addFunction=function(e,t,r){this.functions["{"+e+"}"+t]=r},C.prototype.getFunction=function(e,t){var r=Utilities.resolveQName(e,t.namespaceResolver,t.contextNode,!1);if(null==r[0])throw new Error("Cannot resolve QName "+e);return this.getFunctionWithName(r[0],r[1],t.contextNode)},C.prototype.getFunctionWithName=function(e,t){return this.functions["{"+e+"}"+t]},C.prototype.addStandardFunctions=function(){this.functions["{}last"]=Functions.last,this.functions["{}position"]=Functions.position,this.functions["{}count"]=Functions.count,this.functions["{}match"]=Functions.match,this.functions["{}replace"]=Functions.replace,this.functions["{}id"]=Functions.id,this.functions["{}name"]=Functions.name,this.functions["{}string"]=Functions.string,this.functions["{}concat"]=Functions.concat,this.functions["{}starts-with"]=Functions.startsWith,this.functions["{}contains"]=Functions.contains,this.functions["{}substring-before"]=Functions.substringBefore,this.functions["{}substring-after"]=Functions.substringAfter,this.functions["{}substring"]=Functions.substring,this.functions["{}string-length"]=Functions.stringLength,this.functions["{}normalize-space"]=Functions.normalizeSpace,this.functions["{}translate"]=Functions.translate,this.functions["{}boolean"]=Functions.boolean_,this.functions["{}not"]=Functions.not,this.functions["{}true"]=Functions.true_,this.functions["{}false"]=Functions.false_,this.functions["{}lang"]=Functions.lang,this.functions["{}number"]=Functions.number,this.functions["{}sum"]=Functions.sum,this.functions["{}floor"]=Functions.floor,this.functions["{}ceiling"]=Functions.ceiling,this.functions["{}round"]=Functions.round},Functions=new Object,Functions.last=function(){var e=arguments[0];if(1!=arguments.length)throw new Error("Function last expects ()");return new _(e.contextSize)},Functions.position=function(){var e=arguments[0];if(1!=arguments.length)throw new Error("Function position expects ()");return new _(e.contextPosition)},Functions.count=function(){var e,t=arguments[0];if(2!=arguments.length||!Utilities.instance_of(e=arguments[1].evaluate(t),R))throw new Error("Function count expects (node-set)");return new _(e.size)},Functions.match=function(){var e=arguments[0];if(3!==arguments.length&&4!==arguments.length)throw new Error("Function match expects ({string}source, {string}expression, {string}modifiers)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue(),n=4===arguments.length?arguments[3].evaluate(e).stringValue():"",o=new RegExp(r,n);return new k(o.test(t))},Functions.replace=function(){var e=arguments[0];if(4!=arguments.length&&5!=arguments.length)throw new Error("Function replace expects ({string}source, {string}find, {string}replace, {string}modifiers)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue(),n=arguments[3].evaluate(e).stringValue(),o=5===arguments.length?arguments[4].evaluate(e).stringValue():"",s=new RegExp(r,o);return new S(t.replace(s,n))},Functions.id=function(){var e,t=arguments[0];if(2!=arguments.length)throw new Error("Function id expects (object)");e=arguments[1].evaluate(t),e=Utilities.instance_of(e,R)?e.toArray().join(" "):e.stringValue();for(var r=e.split(/[\x0d\x0a\x09\x20]+/),n=0,o=new R,s=9==t.contextNode.nodeType()?t.contextNode:t.contextNode.ownerDocument(),i=0;i<r.length;i++){var a;a=s.getElementById?s.getElementById(r[i]):Utilities.getElementById(s,r[i]),null!=a&&(o.add(a),n++)}return o},Functions.name=function(){var e,t=arguments[0];if(1==arguments.length)e=t.contextNode;else{if(2!=arguments.length)throw new Error("Function name expects (node-set?)");e=arguments[1].evaluate(t).first()}return null==e?new S(""):1==e.nodeType()||2==e.nodeType()?new S(e.nodeName()):null==e.localName()?new S(""):new S(e.localName())},Functions.string=function(){var e=arguments[0];if(1==arguments.length)return R.prototype.stringForNode(e.contextNode);if(2==arguments.length)return arguments[1].evaluate(e).string();throw new Error("Function string expects (object?)")},Functions.concat=function(){var e=arguments[0];if(arguments.length<3)throw new Error("Function concat expects (string, string, string*)");for(var t="",r=1;r<arguments.length;r++)t+=arguments[r].evaluate(e).stringValue();return new S(t)},Functions.startsWith=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function startsWith expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();return new k(t.substring(0,r.length)==r)},Functions.contains=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function contains expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();return new k(-1!=t.indexOf(r))},Functions.substringBefore=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function substring-before expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();return new S(t.substring(0,t.indexOf(r)))},Functions.substringAfter=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function substring-after expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();if(0==r.length)return new S(t);var n=t.indexOf(r);return-1==n?new S(""):new S(t.substring(t.indexOf(r)+1))},Functions.substring=function(){var e=arguments[0];if(3!=arguments.length&&4!=arguments.length)throw new Error("Function substring expects (string, number, number?)");var t=arguments[1].evaluate(e).stringValue(),r=Math.round(arguments[2].evaluate(e).numberValue())-1,n=4==arguments.length?r+Math.round(arguments[3].evaluate(e).numberValue()):void 0;return new S(t.substring(r,n))},Functions.stringLength=function(){var e,t=arguments[0];if(1==arguments.length)e=R.prototype.stringForNode(t.contextNode);else{if(2!=arguments.length)throw new Error("Function string-length expects (string?)");e=arguments[1].evaluate(t).stringValue()}return new _(e.length)},Functions.normalizeSpace=function(){var e,t=arguments[0];if(1==arguments.length)e=R.prototype.stringForNode(t.contextNode);else{if(2!=arguments.length)throw new Error("Function normalize-space expects (string?)");e=arguments[1].evaluate(t).stringValue()}for(var r=0,n=e.length-1;Utilities.isSpace(e.charCodeAt(n));)n--;for(var o="";n>=r&&Utilities.isSpace(e.charCodeAt(r));)r++;for(;n>=r;)if(Utilities.isSpace(e.charCodeAt(r)))for(o+=" ";n>=r&&Utilities.isSpace(e.charCodeAt(r));)r++;else o+=e.charAt(r),r++;return new S(o)},Functions.translate=function(){var e=arguments[0];if(4!=arguments.length)throw new Error("Function translate expects (string, string, string)");for(var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue(),n=arguments[3].evaluate(e).stringValue(),o=[],s=0;s<r.length;s++){var i=r.charCodeAt(s);if(void 0==o[i]){var a=s>n.length?"":n.charAt(s);o[i]=a}}for(var u="",s=0;s<t.length;s++){var e=t.charCodeAt(s),p=o[e];u+=void 0==p?t.charAt(s):p}return new S(u)},Functions.boolean_=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function boolean expects (object)");return arguments[1].evaluate(e).bool()},Functions.not=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function not expects (object)");return arguments[1].evaluate(e).bool().not()},Functions.true_=function(){if(1!=arguments.length)throw new Error("Function true expects ()");return new k(!0)},Functions.false_=function(){if(1!=arguments.length)throw new Error("Function false expects ()");return new k(!1)},Functions.lang=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function lang expects (string)");for(var r,n=e.contextNode;null!=n&&9!=n.nodeType();n=n.parentNode()){var o=n.getAttributeNS(t.XML_NAMESPACE_URI,"lang");if(null!=o){r=String(o);break}}if(null==r)return new k(!1);var s=arguments[1].evaluate(e).stringValue();return new k(r.substring(0,s.length)==s&&(r.length==s.length||"-"==r.charAt(s.length)))},Functions.number=function(){var e=arguments[0];if(1!=arguments.length&&2!=arguments.length)throw new Error("Function number expects (object?)");
return 1==arguments.length?new _(R.prototype.stringForNode(e.contextNode)):arguments[1].evaluate(e).number()},Functions.sum=function(){var e,t=arguments[0];if(2!=arguments.length||!Utilities.instance_of(e=arguments[1].evaluate(t),R))throw new Error("Function sum expects (node-set)");e=e.toArray();for(var r=0,n=0;n<e.length;n++)r+=new _(R.prototype.stringForNode(e[n])).numberValue();return new _(r)},Functions.floor=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function floor expects (number)");return new _(Math.floor(arguments[1].evaluate(e).numberValue()))},Functions.ceiling=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function ceiling expects (number)");return new _(Math.ceil(arguments[1].evaluate(e).numberValue()))},Functions.round=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function round expects (number)");return new _(Math.round(arguments[1].evaluate(e).numberValue()))},Utilities=new Object,Utilities.splitQName=function(e){if(!e)return"";var t=e.indexOf(":");return-1==t?[null,e]:[e.substring(0,t),e.substring(t+1)]},Utilities.resolveQName=function(e,t,r,n){var o=Utilities.splitQName(e);return null!=o[0]?o[0]=t.getNamespace(o[0],r):n?(o[0]=t.getNamespace("",r),null==o[0]&&(o[0]="")):o[0]="",o},Utilities.isSpace=function(e){return 9==e||13==e||10==e||32==e},Utilities.isLetter=function(e){return e>=65&&90>=e||e>=97&&122>=e||e>=192&&214>=e||e>=216&&246>=e||e>=248&&255>=e||e>=256&&305>=e||e>=308&&318>=e||e>=321&&328>=e||e>=330&&382>=e||e>=384&&451>=e||e>=461&&496>=e||e>=500&&501>=e||e>=506&&535>=e||e>=592&&680>=e||e>=699&&705>=e||902==e||e>=904&&906>=e||908==e||e>=910&&929>=e||e>=931&&974>=e||e>=976&&982>=e||986==e||988==e||990==e||992==e||e>=994&&1011>=e||e>=1025&&1036>=e||e>=1038&&1103>=e||e>=1105&&1116>=e||e>=1118&&1153>=e||e>=1168&&1220>=e||e>=1223&&1224>=e||e>=1227&&1228>=e||e>=1232&&1259>=e||e>=1262&&1269>=e||e>=1272&&1273>=e||e>=1329&&1366>=e||1369==e||e>=1377&&1414>=e||e>=1488&&1514>=e||e>=1520&&1522>=e||e>=1569&&1594>=e||e>=1601&&1610>=e||e>=1649&&1719>=e||e>=1722&&1726>=e||e>=1728&&1742>=e||e>=1744&&1747>=e||1749==e||e>=1765&&1766>=e||e>=2309&&2361>=e||2365==e||e>=2392&&2401>=e||e>=2437&&2444>=e||e>=2447&&2448>=e||e>=2451&&2472>=e||e>=2474&&2480>=e||2482==e||e>=2486&&2489>=e||e>=2524&&2525>=e||e>=2527&&2529>=e||e>=2544&&2545>=e||e>=2565&&2570>=e||e>=2575&&2576>=e||e>=2579&&2600>=e||e>=2602&&2608>=e||e>=2610&&2611>=e||e>=2613&&2614>=e||e>=2616&&2617>=e||e>=2649&&2652>=e||2654==e||e>=2674&&2676>=e||e>=2693&&2699>=e||2701==e||e>=2703&&2705>=e||e>=2707&&2728>=e||e>=2730&&2736>=e||e>=2738&&2739>=e||e>=2741&&2745>=e||2749==e||2784==e||e>=2821&&2828>=e||e>=2831&&2832>=e||e>=2835&&2856>=e||e>=2858&&2864>=e||e>=2866&&2867>=e||e>=2870&&2873>=e||2877==e||e>=2908&&2909>=e||e>=2911&&2913>=e||e>=2949&&2954>=e||e>=2958&&2960>=e||e>=2962&&2965>=e||e>=2969&&2970>=e||2972==e||e>=2974&&2975>=e||e>=2979&&2980>=e||e>=2984&&2986>=e||e>=2990&&2997>=e||e>=2999&&3001>=e||e>=3077&&3084>=e||e>=3086&&3088>=e||e>=3090&&3112>=e||e>=3114&&3123>=e||e>=3125&&3129>=e||e>=3168&&3169>=e||e>=3205&&3212>=e||e>=3214&&3216>=e||e>=3218&&3240>=e||e>=3242&&3251>=e||e>=3253&&3257>=e||3294==e||e>=3296&&3297>=e||e>=3333&&3340>=e||e>=3342&&3344>=e||e>=3346&&3368>=e||e>=3370&&3385>=e||e>=3424&&3425>=e||e>=3585&&3630>=e||3632==e||e>=3634&&3635>=e||e>=3648&&3653>=e||e>=3713&&3714>=e||3716==e||e>=3719&&3720>=e||3722==e||3725==e||e>=3732&&3735>=e||e>=3737&&3743>=e||e>=3745&&3747>=e||3749==e||3751==e||e>=3754&&3755>=e||e>=3757&&3758>=e||3760==e||e>=3762&&3763>=e||3773==e||e>=3776&&3780>=e||e>=3904&&3911>=e||e>=3913&&3945>=e||e>=4256&&4293>=e||e>=4304&&4342>=e||4352==e||e>=4354&&4355>=e||e>=4357&&4359>=e||4361==e||e>=4363&&4364>=e||e>=4366&&4370>=e||4412==e||4414==e||4416==e||4428==e||4430==e||4432==e||e>=4436&&4437>=e||4441==e||e>=4447&&4449>=e||4451==e||4453==e||4455==e||4457==e||e>=4461&&4462>=e||e>=4466&&4467>=e||4469==e||4510==e||4520==e||4523==e||e>=4526&&4527>=e||e>=4535&&4536>=e||4538==e||e>=4540&&4546>=e||4587==e||4592==e||4601==e||e>=7680&&7835>=e||e>=7840&&7929>=e||e>=7936&&7957>=e||e>=7960&&7965>=e||e>=7968&&8005>=e||e>=8008&&8013>=e||e>=8016&&8023>=e||8025==e||8027==e||8029==e||e>=8031&&8061>=e||e>=8064&&8116>=e||e>=8118&&8124>=e||8126==e||e>=8130&&8132>=e||e>=8134&&8140>=e||e>=8144&&8147>=e||e>=8150&&8155>=e||e>=8160&&8172>=e||e>=8178&&8180>=e||e>=8182&&8188>=e||8486==e||e>=8490&&8491>=e||8494==e||e>=8576&&8578>=e||e>=12353&&12436>=e||e>=12449&&12538>=e||e>=12549&&12588>=e||e>=44032&&55203>=e||e>=19968&&40869>=e||12295==e||e>=12321&&12329>=e},Utilities.isNCNameChar=function(e){return e>=48&&57>=e||e>=1632&&1641>=e||e>=1776&&1785>=e||e>=2406&&2415>=e||e>=2534&&2543>=e||e>=2662&&2671>=e||e>=2790&&2799>=e||e>=2918&&2927>=e||e>=3047&&3055>=e||e>=3174&&3183>=e||e>=3302&&3311>=e||e>=3430&&3439>=e||e>=3664&&3673>=e||e>=3792&&3801>=e||e>=3872&&3881>=e||46==e||45==e||95==e||Utilities.isLetter(e)||e>=768&&837>=e||e>=864&&865>=e||e>=1155&&1158>=e||e>=1425&&1441>=e||e>=1443&&1465>=e||e>=1467&&1469>=e||1471==e||e>=1473&&1474>=e||1476==e||e>=1611&&1618>=e||1648==e||e>=1750&&1756>=e||e>=1757&&1759>=e||e>=1760&&1764>=e||e>=1767&&1768>=e||e>=1770&&1773>=e||e>=2305&&2307>=e||2364==e||e>=2366&&2380>=e||2381==e||e>=2385&&2388>=e||e>=2402&&2403>=e||e>=2433&&2435>=e||2492==e||2494==e||2495==e||e>=2496&&2500>=e||e>=2503&&2504>=e||e>=2507&&2509>=e||2519==e||e>=2530&&2531>=e||2562==e||2620==e||2622==e||2623==e||e>=2624&&2626>=e||e>=2631&&2632>=e||e>=2635&&2637>=e||e>=2672&&2673>=e||e>=2689&&2691>=e||2748==e||e>=2750&&2757>=e||e>=2759&&2761>=e||e>=2763&&2765>=e||e>=2817&&2819>=e||2876==e||e>=2878&&2883>=e||e>=2887&&2888>=e||e>=2891&&2893>=e||e>=2902&&2903>=e||e>=2946&&2947>=e||e>=3006&&3010>=e||e>=3014&&3016>=e||e>=3018&&3021>=e||3031==e||e>=3073&&3075>=e||e>=3134&&3140>=e||e>=3142&&3144>=e||e>=3146&&3149>=e||e>=3157&&3158>=e||e>=3202&&3203>=e||e>=3262&&3268>=e||e>=3270&&3272>=e||e>=3274&&3277>=e||e>=3285&&3286>=e||e>=3330&&3331>=e||e>=3390&&3395>=e||e>=3398&&3400>=e||e>=3402&&3405>=e||3415==e||3633==e||e>=3636&&3642>=e||e>=3655&&3662>=e||3761==e||e>=3764&&3769>=e||e>=3771&&3772>=e||e>=3784&&3789>=e||e>=3864&&3865>=e||3893==e||3895==e||3897==e||3902==e||3903==e||e>=3953&&3972>=e||e>=3974&&3979>=e||e>=3984&&3989>=e||3991==e||e>=3993&&4013>=e||e>=4017&&4023>=e||4025==e||e>=8400&&8412>=e||8417==e||e>=12330&&12335>=e||12441==e||12442==e||183==e||720==e||721==e||903==e||1600==e||3654==e||3782==e||12293==e||e>=12337&&12341>=e||e>=12445&&12446>=e||e>=12540&&12542>=e},Utilities.coalesceText=function(e){for(var t=e.firstChild();null!=t;t=t.nextSibling())if(3==t.nodeType()||4==t.nodeType()){var r=t.nodeValue(),n=t;for(t=t.nextSibling();null!=t&&(3==t.nodeType()||4==t.nodeType());){r+=t.nodeValue();var o=t;t=t.nextSibling(),o.parentNode().removeChild(o)}if(4==n.nodeType()){var s=n.parentNode();if(null==n.nextSibling())s.removeChild(n),s.appendChild(s.ownerDocument().createTextNode(r));else{var i=n.nextSibling();s.removeChild(n),s.insertBefore(s.ownerDocument().createTextNode(r),i)}}else n.nodeValue(r);if(null==t)break}else 1==t.nodeType()&&Utilities.coalesceText(t)},Utilities.instance_of=function(e,t){for(;null!=e;){if(e.constructor===t)return!0;if(e===Object)return!1;e=e.constructor.superclass}return!1},Utilities.getElementById=function(e,t){if(1==e.nodeType()&&(e.getAttribute("id")==t||e.getAttributeNS(null,"id")==t))return e;for(var r=e.firstChild();null!=r;r=r.nextSibling()){var n=Utilities.getElementById(r,t);if(null!=n)return n}return null},U.prototype={},U.prototype.constructor=U,U.superclass=Object.prototype,U.prototype.toString=function(){var e=this.exception?": "+this.exception.toString():"";switch(this.code){case U.INVALID_EXPRESSION_ERR:return"Invalid expression"+e;case U.TYPE_ERR:return"Type error"+e}},U.INVALID_EXPRESSION_ERR=51,U.TYPE_ERR=52,P.prototype={},P.prototype.constructor=P,P.superclass=Object.prototype,P.prototype.evaluate=function(e,t){this.context.expressionContextNode=e;var r=this.xpath.evaluate(this.context);return new j(r,t)},L.prototype={},L.prototype.constructor=L,L.superclass=Object.prototype,L.prototype.getNamespace=function(e){return null==this.xpathNSResolver?null:this.xpathNSResolver.lookupNamespaceURI(e)},M.prototype={},M.prototype.constructor=M,M.superclass=Object.prototype,M.prototype.lookupNamespaceURI=function(e){return this.namespaceResolver.getNamespace(e,this.node)},j.prototype={},j.prototype.constructor=j,j.superclass=Object.prototype,j.prototype.iterateNext=function(){if(this.resultType!=j.UNORDERED_NODE_ITERATOR_TYPE&&this.resultType!=j.ORDERED_NODE_ITERATOR_TYPE)throw new U(U.TYPE_ERR);return this.nodes[this.iteratorIndex++]},j.prototype.snapshotItem=function(e){if(this.resultType!=j.UNORDERED_NODE_SNAPSHOT_TYPE&&this.resultType!=j.ORDERED_NODE_SNAPSHOT_TYPE)throw new U(U.TYPE_ERR);return this.nodes[e]},j.ANY_TYPE=0,j.NUMBER_TYPE=1,j.STRING_TYPE=2,j.BOOLEAN_TYPE=3,j.UNORDERED_NODE_ITERATOR_TYPE=4,j.ORDERED_NODE_ITERATOR_TYPE=5,j.UNORDERED_NODE_SNAPSHOT_TYPE=6,j.ORDERED_NODE_SNAPSHOT_TYPE=7,j.ANY_UNORDERED_NODE_TYPE=8,j.FIRST_ORDERED_NODE_TYPE=9,q.prototype={constructor:q,toValue:function(){return this.value}},Y.prototype={init:function(e){return this.node=new G(e,null,this),this.cache={childNodes:[this.node]},this},schema:function(e){return"object"==typeof e&&H(e,function(e,t){this._schema[t]=e},this),this},map:function(e){return this._map=e,this},nodeType:function(){return 9},documentElement:function(){return this.node},nodeName:function(){return"#document"},localName:function(){return this.nodeName()},firstChild:function(){return this.node},nextSibling:function(){return null},previousSibling:function(){return null},childNodes:function(){return this.cache.childNodes},parentNode:function(){return null},attributes:function(){return this.node.attributes()},nodeValue:function(){return this._node},selectAll:function(e){this.init("function"==typeof this._schema.onPreProcess?this._schema.onPreProcess.call(this,this._node):this._node),"function"==typeof this._schema.onPreProcess&&(this.__node=this._node,this._node=this.node.node);var t=V(e,this,!1,this._map);if(t instanceof Array){t=H(t,function(e){return e.toValue()});try{Object.defineProperty(t,"each",{enumerable:!1,value:function(e,r){return H(t,e,r)}})}catch(r){t.each=function(e,r){return H(t,e,r)}}}return"function"==typeof this._schema.onPreProcess&&(this._node=this.__node),"function"==typeof this._schema.onPostProcess&&(t=this._schema.onPostProcess.call(this,t)),t},select:function(e){var t=this.selectAll(e);return t instanceof Array?t.length?t[0]:null:t},dispose:function(e){var t,r,n;e===!0&&(t=this.node.node,r=this._schema,n=this._map),this.node.dispose(),e&&this.init(t),this._schema=r,this._map=n}},G.prototype={nodeType:function(){return 1},ownerDocument:function(){return this.cache.ownerDocument},root:function(){return this.cache.ownerDocument.nodeValue()},adapter:function(e){return"function"==typeof this.cache.ownerDocument._schema[e]?this.cache.ownerDocument._schema[e].call(this,this.node):"string"==typeof this.cache.ownerDocument._schema[e]?this.node[this.cache.ownerDocument._schema[e]]:null},childNodes:function(){if("undefined"==typeof this.cache.childNodes){var e,t=this.adapter("childNodes"),r=this.adapter("nodeValue");this.cache.childNodes=[],t&&H(t,function(t){t instanceof W?(e=new G(t.childNodes,this,this.cache.ownerDocument),e.cache.nodeName=t.nodeName,this.cache.childNodes.push(e)):this.cache.childNodes.push(new G(t,this,this.cache.ownerDocument))},this),r&&(e=new $(r,this,this.cache.ownerDocument),this.cache.childNodes.splice(0,0,e))}return this.cache.childNodes},parentNode:function(){return this.cache.parentNode},getIndex:function(){if("number"!=typeof this.cache.index)if(this.cache.parentNode){var e,t=this.parentNode().childNodes();for(e=0;e<t.length;e++)if(t[e]===this){this.cache.index=e;break}}else this.cache.index=0;return this.cache.index},firstChild:function(){var e=this.childNodes();return e.length>0?e[0]:null},nextSibling:function(){if(this.cache.parentNode){var e=this.parentNode().childNodes(),t=this.getIndex();return t<e.length-1?e[t+1]:null}return null},previousSibling:function(){if(this.cache.parentNode){var e=this.parentNode().childNodes(),t=this.getIndex();return t>0?e[t-1]:null}return null},nodeName:function(){return this.cache.nodeName||(this.cache.nodeName=this.adapter("nodeName")),this.cache.nodeName},localName:function(){return this.nodeName()},nodeValue:function(){return"undefined"==typeof this.cache.nodeValue&&(this.cache.nodeValue=this.adapter("nodeValue")),this.cache.nodeValue},getAttribute:function(e){var t=this.attributes();return null!==t?t.values[e]:void 0},getAttributeNS:function(e){return this.getAttribute(e)},attributes:function(){if("undefined"==typeof this.cache.attributes){var e=this.adapter("attributes"),t=null,r=this;e?(t=B(e),this.cache.attributes={length:t.length,values:e,item:function(n){return new z(t[n],e[t[n]],r)}}):this.cache.attributes=null}return this.cache.attributes},toValue:function(){return this.node instanceof q?this.node.toValue():this.node},dispose:function(){this.cache.childNodes&&H(this.cache.childNodes,function(e){e.dispose()}),this.cache.parentNode&&delete this.cache.parentNode,H(this.cache,function(e,t){delete this.cache[t]},this),delete this.node}},z.prototype={nodeType:function(){return 2},nodeName:function(){return this.name},localName:function(){return this.nodeName()},nodeValue:function(){return this.value},parentNode:function(){return this.cache.parentNode},toValue:function(){return this.value},previousSibling:function(){return null},nextSibling:function(){return null},firstChild:function(){return null}},$.prototype=new G,$.prototype.constructor=$,$.prototype.nodeType=function(){return 3},$.prototype.nodeName=function(){return"#text"},$.prototype.nodeValue=function(){return this.txt},$.prototype.childNodes=function(){return null},$.prototype.firstChild=function(){return null},$.prototype.toValue=function(){return this.txt};var Q={nodeName:function(e){return e instanceof W?e.nodeName:e instanceof Array?"array":typeof e},attributes:function(e){if(e instanceof W)return null;var t={};for(var r in e)e.hasOwnProperty(r)&&("string"==typeof e[r]||"number"==typeof e[r]||e[r]instanceof Date||e[r]instanceof RegExp)&&(t[r]=e[r]);return t},childNodes:function(e){if(e instanceof W)return e.childNodes;if(e instanceof Array)return e;var t=[];for(var r in e)e.hasOwnProperty(r)&&("object"==typeof e[r]||e[r]instanceof Array)&&t.push(new W(r,e[r]));return t},nodeValue:function(e){return"object"==typeof e||e instanceof Array?null:e}};return module.exports=function(e){return new Y(e)},module.exports.Node=function(e,t){return new q(e,t)},module.exports.isNode=function(e,t){return t?e instanceof q&&e.nodeName===t:e instanceof q},module.exports.schema={Default:Q},module.exports}();